# =============================================================================
# Single Auth Service Configuration
# =============================================================================
# Copy this file to .env and adjust values for your environment
# NEVER commit .env to version control

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_IDLE_TIMEOUT=120s

# -----------------------------------------------------------------------------
# PostgreSQL Configuration
# -----------------------------------------------------------------------------
DB_HOST=localhost
DB_PORT=5432
DB_USER=auth
DB_PASSWORD=your_secure_password_here
DB_NAME=auth_service
DB_SSL_MODE=disable
# Production: use 'require' or 'verify-full' for SSL
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=5

# -----------------------------------------------------------------------------
# JWT Configuration
# -----------------------------------------------------------------------------
# IMPORTANT: Use HTTPS URL in production!
JWT_ISSUER=https://auth.example.com

# Token lifetimes
JWT_ACCESS_TOKEN_TTL=15m
JWT_REFRESH_TOKEN_TTL=168h    # 7 days
JWT_ID_TOKEN_TTL=1h
JWT_AUTH_CODE_TTL=10m

# Key rotation
JWT_KEY_ROTATION_INTERVAL=24h
JWT_KEY_VALIDITY_PERIOD=168h  # 7 days (keys valid for verification after rotation)

# -----------------------------------------------------------------------------
# Argon2 Password Hashing (OWASP Recommended)
# -----------------------------------------------------------------------------
ARGON2_MEMORY=65536           # 64 MB
ARGON2_ITERATIONS=3
ARGON2_PARALLELISM=4
ARGON2_SALT_LENGTH=16
ARGON2_KEY_LENGTH=32

# -----------------------------------------------------------------------------
# Session Management
# -----------------------------------------------------------------------------
MAX_DEVICES_PER_USER=10

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
# CORS: Comma-separated list of allowed origins
ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com

# CSRF settings
CSRF_TOKEN_LENGTH=32

# Cookies
SECURE_COOKIES=true           # Set to false only for local development
COOKIE_DOMAIN=.example.com
COOKIE_SAME_SITE=Strict       # Strict, Lax, or None

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPS=100            # Requests per second
RATE_LIMIT_BURST=200          # Burst capacity

# -----------------------------------------------------------------------------
# External OAuth Providers (Future)
# -----------------------------------------------------------------------------
# Google OAuth
# GOOGLE_CLIENT_ID=
# GOOGLE_CLIENT_SECRET=
# GOOGLE_REDIRECT_URI=https://auth.example.com/callback/google

# Apple Sign In
# APPLE_CLIENT_ID=
# APPLE_TEAM_ID=
# APPLE_KEY_ID=
# APPLE_PRIVATE_KEY_PATH=
